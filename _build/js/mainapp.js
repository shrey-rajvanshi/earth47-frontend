!function(e){"use strict";var t=e.module("earth47App",["ui.router","Home.Controller","SolarHome.Controller","About.Controller","ProjectsListing.Controller","ProjectDetail.Controller","ProjectPayment.Controller","activeLink","DesktopNav.Directive","Footer.Directive","MobileSideNav.Directive","ngSanitize","Thankyou.Controller","loaderDirective","imageLoader"]);t.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){e.state("home",{url:"/",templateUrl:"src/templates/home.html",controller:"homeController"}).state("solarhome",{url:"/solar",templateUrl:"src/templates/solarHome.html",controller:"solarHomeController"}).state("about",{url:"/about",templateUrl:"src/templates/about.html",controller:"aboutController",redirectTo:"about.ourStory"}).state("about.ourStory",{url:"/story",templateUrl:"src/templates/ourStory.html"}).state("about.howWeFight",{url:"/howwefight",templateUrl:"src/templates/howWeFight.html"}).state("about.partners",{url:"/partners",templateUrl:"src/templates/ourPartners.html"}).state("about.faqs",{url:"/faqs",templateUrl:"src/templates/faqs.html"}).state("about.contactUs",{url:"/contact",templateUrl:"src/templates/contactus.html"}).state("projects",{url:"/projects",templateUrl:"src/templates/projectsListing.html",controller:"projectsListingController"}).state("projectDetails",{url:"/project/:projectId/:projectSlug",templateUrl:"src/templates/projectDetail.html",controller:"projectDetailController"}).state("projectPayment",{url:"/project/payment/:projectId/:projectSlug",templateUrl:"src/templates/projectPayment.html",params:{projectId:{squash:!0,value:null},projectSlug:{squash:!0,value:null}},controller:"projectPaymentController"}).state("termsConditions",{url:"/terms",templateUrl:"src/templates/termsConditions.html"}).state("privacyPolicy",{url:"/privacypolicy",templateUrl:"src/templates/privacyPolicy.html"}).state("refundPolicy",{url:"/refundpolicy",templateUrl:"src/templates/refundPolicy.html"}).state("thankyou",{url:"/thankyou",templateUrl:"src/templates/thankyou.html",controller:"thankyou"}),t.otherwise("/"),o.html5Mode(!0)}]),t.run(["$rootScope","$state",function(e,t){e.hideFooter=!1,e.hideMainNav=!1,e.$watch(function(){return t.$current.name},function(t,o){e.hideNewsletter=!1,!t||t.indexOf("projectPayment")===-1&&t.indexOf("termsConditions")===-1&&t.indexOf("privacyPolicy")===-1&&t.indexOf("refundPolicy")===-1?t&&t.indexOf("projectDetails")!==-1?(e.hideFooter=!0,e.hideMainNav=!1):t&&t.indexOf("thankyou")!==-1?e.hideNewsletter=!0:(e.hideFooter=!1,e.hideMainNav=!1):(e.hideFooter=!0,e.hideMainNav=!0)})}])}(angular),angular.module("activeLink",[]).directive("activeLink",["$location",function(e){return{restrict:"A",link:function(t,o,n,r){var i=n.activeLink,a=n.navState;t.location=e,(e.$$path.indexOf(a)!==-1||"home"===a&&"/"===e.$$path||"projects"===a&&"/thankyou"===e.$$path)&&o.addClass(i),t.$watch("location.$$path",function(t){t.indexOf(a)!==-1||"home"===a&&"/"===e.$$path||"projects"===a&&"/thankyou"===e.$$path?o.addClass(i):o.removeClass(i)})}}}]),angular.module("DesktopNav.Directive",[]).directive("desktopnav",["$window","ProjectsModel",function(e,t){return{restrict:"E",link:function(o,n,r,i){function a(){o.projectsModel.logout().then(function(){window.location.reload(),console.log("successfull logout ")})}r.footer||angular.element(e).bind("scroll",function(){this.pageYOffset>=12?($(".nav-wrap").addClass("sticky-nav"),$(".navbar-default.main-nav").removeClass("nav-padding-top"),$(".nav-wrap").addClass("nav-wrap-height"),$(".navbar-default.main-nav").addClass("nav-padding-top-6")):(n.find("nav").removeClass("sticky-nav"),$(".nav-wrap").removeClass("sticky-nav"),$(".navbar-default.main-nav").addClass("nav-padding-top"),$(".nav-wrap").removeClass("nav-wrap-height"),$(".navbar-default.main-nav").removeClass("nav-padding-top-6"))}),o.projectsModel=(new t).getInstance(),o.projectsModel.getSession().then(function(e){e.user&&e.user_id&&(o.showUserIcon=!0),o.showUserIcon&&e.user.picture_link&&(o.profilePicLink=e.user.picture_link)}),$(".logout-dropdown").hide(),$(".logout-dropdown-icon").click(function(e){e.stopPropagation(),$(".logout-dropdown").show()}),$(document).click(function(){$(".logout-dropdown").hide()}),$(".logout-dropdown").click(function(e){e.stopPropagation(),a()})},templateUrl:"src/templates/desktopNav.html",controller:["$scope","$rootScope","$state",function(e,t,o){e.hideMainNav=t.hideMainNav,e.goToBlog=function(){window.location.replace("/blog")}}]}}]),angular.module("MobileSideNav.Directive",[]).directive("mobileSideNav",["$window",function(e){return{restrict:"E",link:function(e,t,o,n){$("#hamburger-icon").on("click",function(){event.stopPropagation(),$(".side-mnav").addClass("side-mnav-width")}),$("html").click(function(){$(".side-mnav").hasClass("side-mnav-width")&&$(".side-mnav").removeClass("side-mnav-width")}),$(".side-mnav").click(function(e){e.stopPropagation()})},templateUrl:"src/templates/mobileSideNav.html",controller:["$scope","$rootScope","$state","ProjectsModel",function(e,t,o,n){e.showAboutusOptions=!1,e.hideNav=function(){$(".side-mnav").hasClass("side-mnav-width")&&$(".side-mnav").removeClass("side-mnav-width")},e.toggleAboutusOptions=function(){e.showAboutusOptions=!e.showAboutusOptions},e.goToBlog=function(){window.location.replace("/blog")},e.projectsModel=(new n).getInstance(),e.projectsModel.getSession().then(function(t){t.user_id&&(e.showLogout=!0)}),e.logout=function(){e.projectsModel.logout().then(function(){window.location.reload(),console.log("successfull logout ")})}}]}}]),function(e){"use strict";var t=e.module("Home.Controller",["ProjectsWeSupport.Directive","Testimonials.Directive","BlogsCorousel.Directive"]);t.controller("homeController",["$scope","$location","$rootScope",function(e,t,o){e.goToViewProjects=function(){t.url("projects")},e.goToHowThisWorks=function(){t.url("about/howwefight")},console.log(o.fullViewLoader)}])}(angular),function(e){"use strict";var t=e.module("SolarHome.Controller",["ProjectsWeSupport.Directive","Testimonials.Directive","BlogsCorousel.Directive"]);t.controller("solarHomeController",["$scope","$location","$rootScope",function(e,t,o){e.goToViewProjects=function(){t.url("projects")},e.goToHowThisWorks=function(){t.url("about/howwefight")},console.log(o.fullViewLoader)}])}(angular),function(e){"use strict";var t=e.module("About.Controller",["slickCarousel","ProjectsWeSupport.Directive","AboutNav.Directive","Projects.Model","AboutMobileNav.Directive"]);t.controller("aboutController",["$scope","ProjectsModel",function(e,t){e.projectsModel=(new t).getInstance(),e.showForm=!0,e.window=window,e.continueReading=function(){$(".read-more-wrap").css({display:"block"}),$(".continue-reading-block").css({display:"none"})},e.submitForm=function(){var t={name:contactUsForm.name.value,email:contactUsForm.email.value,phone:contactUsForm.phone.value,message:contactUsForm.message.value};e.projectsModel.submitContactForm(t).then(function(){e.success=!0,e.showForm=!1},function(){console.log("Something went wrong.")}),e.successDone=function(){e.showForm=!0,e.success=!1,contactUsForm.name.value=null,contactUsForm.email.value=null,contactUsForm.phone.value=null,contactUsForm.message.value=null}}}])}(angular),angular.module("Footer.Directive",[]).directive("footer",["$window","ProjectsModel",function(e,t){return{restrict:"E",link:function(e,t,o,n){},templateUrl:"src/templates/footer.html",controller:["$scope","$rootScope",function(e,o){e.hideFooter=o.hideFooter,e.hideNewsletter=o.hideNewsletter,e.projectsModel=(new t).getInstance(),e.goToBlog=function(){window.location.replace("/blog")},e.subscribe=function(){newsLetterForm[0].validity.valid&&e.projectsModel.subscribe({email:e.userEmail}).then(function(){e.showSuccessMessage=!0},function(e){console.log("Something went wrong")})}}]}}]),function(e){"use strict";var t=e.module("ExploreProjects.Directive",["slickCarousel"]);t.directive("exploreProjects",[function(){return{scope:{projects:"="},link:function(e,t,o){},controller:["$scope","$http","$stateParams","$location","$rootScope",function(e,t,o,n,r){function i(e){return e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}var a=!1;(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i))&&(a=!0),e.slickConfig={enabled:!0,slidesToScroll:1,infinite:!0,autoplay:!1,dots:window.innerWidth<=768,arrows:window.innerWidth>768,draggable:!1,slidesToShow:window.innerWidth>=1246?3:window.innerWidth>=768?2:1,method:{},event:{beforeChange:function(e,t,o,n){}}},r.fullViewLoader.showLoader(),t({method:"GET",url:"https://www.earth47.com/api/projects"}).then(function(t){e.projectsArray=t.data.projects,e.projectsArray=e.projectsArray.filter(function(e){return e.id!=o.projectId}),r.fullViewLoader.hideLoader()},function(e){console.log("Failed to fetch projects"),r.fullViewLoader.hideLoader()}),e.goToProjectDetail=function(e,t){n.url("project/"+e+"/"+i(t))}}],templateUrl:"src/templates/exploreProjects.html"}}])}(angular),angular.module("AboutMobileNav.Directive",[]).directive("aboutMobileNav",["$location","$window","$timeout",function(e,t,o){return{restrict:"A",link:function(n,r,i,a){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i)){o(function(){e.$$path.indexOf("story")!==-1?$(".about-nav-mobile-list").scrollLeft($(".nav-item-story").position().left-window.innerWidth/3):e.$$path.indexOf("howwefight")!==-1?$(".about-nav-mobile-list").scrollLeft($(".nav-item-howwefight").position().left-window.innerWidth/3):e.$$path.indexOf("partners")!==-1?$(".about-nav-mobile-list").scrollLeft($(".nav-item-partners").position().left-window.innerWidth/3):e.$$path.indexOf("faqs")!==-1?$(".about-nav-mobile-list").scrollLeft($(".nav-item-faqs").position().left-window.innerWidth/3):e.$$path.indexOf("contact")!==-1&&$(".about-nav-mobile-list").scrollLeft($(".nav-item-contact").position().left-window.innerWidth/3)});var c=330;angular.element(t).bind("scroll",function(){this.pageYOffset>=c?($(".aboutus-nav-mobile").addClass("about-nav-mobile-sticky"),$(".about-common-parent").addClass("margin-top-52")):($(".aboutus-nav-mobile").removeClass("about-nav-mobile-sticky"),$(".about-common-parent").removeClass("margin-top-52"))}),$(".scroll-icon-next").click(function(){$(".about-nav-mobile-list").animate({scrollLeft:$(".about-nav-mobile-list").scrollLeft()+window.innerWidth/3},500)}),$(".scroll-icon-prev").click(function(){$(".about-nav-mobile-list").animate({scrollLeft:$(".about-nav-mobile-list").scrollLeft()-window.innerWidth/3},500)}),n.setScrollPosition=function(){$("html, body").animate({scrollTop:c+2},300)}}}}}]),function(e){"use strict";var t=e.module("ProjectsWeSupport.Directive",["slickCarousel"]);t.directive("projectsWeSupport",["$rootScope",function(e){return{scope:{projects:"="},link:function(e,t,o){},controller:["$scope","$http","$location",function(t,o,n){function r(e){return e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}var i=!1;(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i))&&(i=!0),e.fullViewLoader.showLoader(),o({method:"GET",url:"https://www.earth47.com/api/projects"}).then(function(o){t.projectsArray=o.data.projects,t.projectArray=t.projectsArray.map(function(e){return e.goal_acheived=Math.round(e.achieved_funding/e.target_funding*100)+"%"}),e.fullViewLoader.hideLoader()},function(t){console.log("Failed to fetch projects"),e.fullViewLoader.hideLoader()}),t.goToViewProjects=function(){n.url("projects")},t.slickConfig={enabled:!0,autoplay:!1,dots:window.innerWidth<=768,arrows:window.innerWidth>768,draggable:!1,method:{},event:{beforeChange:function(e,t,o,n){}}},t.goToProjectDetail=function(e,t){n.url("project/"+e+"/"+r(t))}}],templateUrl:"src/templates/projectsCorousel.html"}}])}(angular),angular.module("stickyCard",[]).directive("stickyCard",["$window","$timeout",function(e,t){return{restrict:"A",link:function(o,n,r,i){t(function(){var t=$(".project-progress-card").offset().top-60,o=$(".project-progress-card").height(),r=$(".explore-other-projects").offset().top-60;angular.element(e).bind("scroll",function(){this.pageYOffset>=t&&this.pageYOffset<=r-o?(n.addClass("sticky-card"),n[0].style.removeProperty("margin-top"),n[0].style.removeProperty("position")):this.pageYOffset>r-o?n.css({position:"absolute","margin-top":$(".project-detail-main-block").height()-o-120+"px"}):(n[0].style.removeProperty("margin-top"),n[0].style.removeProperty("position"),n.removeClass("sticky-card"))})},1500)}}}]),angular.module("stickyNav",[]).directive("stickyNav",["$window","$timeout",function(e,t){return{restrict:"A",link:function(o,n,r,i){t(function(){var t=!1,r=$(".project-detail-nav").offset().top-60;(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i))&&(t=!0);var i=t?$(".project-impact").offset().top-120:$(".project-impact").offset().top-80,a=t?$(".project-challenges").offset().top-140:$(".project-challenges").offset().top-100,c=t?$(".project-verification").offset().top-140:$(".project-verification").offset().top-100;n.css({width:$(".project-detail-main-block").width()}),o.scrollTo=function(e){var t=$(".project-"+e).offset().top-70;"impact"===e?t=i+20:"challenges"===e?t=a+20:"verification"===e&&(t=c+20),$("html, body").animate({scrollTop:t},200)},angular.element(e).bind("scroll",function(){this.pageYOffset>=r?t?(n.addClass("sticky-project-nav-mobile"),$(".details-padding").addClass("padding-top-40")):(n.addClass("sticky-project-nav"),$(".details-padding").addClass("padding-top-60")):t?(n.removeClass("sticky-project-nav-mobile"),$(".details-padding").removeClass("padding-top-40")):(n.removeClass("sticky-project-nav"),$(".details-padding").removeClass("padding-top-60")),this.pageYOffset>r&&this.pageYOffset<i?($(".nav-item-overview").addClass("active-link-overview"),$(".nav-item-impact").removeClass("active-link-overview")):this.pageYOffset>i&&this.pageYOffset<a?($(".nav-item-overview").removeClass("active-link-overview"),$(".nav-item-challenges").removeClass("active-link-overview"),$(".nav-item-impact").addClass("active-link-overview")):this.pageYOffset>a&&this.pageYOffset<c?($(".nav-item-impact").removeClass("active-link-overview"),$(".nav-item-verification").removeClass("active-link-overview"),$(".nav-item-challenges").addClass("active-link-overview")):this.pageYOffset>c&&($(".nav-item-challenges").removeClass("active-link-overview"),$(".nav-item-verification").addClass("active-link-overview"))})},1500)}}}]),function(e){"use strict";var t=e.module("LoginModal.Directive",[]);t.directive("loginModal",[function(){return{scope:{hideLoginModal:"&"},link:function(e,t,o){e.loginWithFacebook=function(){window.open("http://www.earth47.com/api/authorize/facebook","_parent")},e.loginWithGoogle=function(){window.open("http://www.earth47.com/api/authorize/google","_parent")},e.callHideModal=function(){e.hideLoginModal()}},templateUrl:"src/templates/loginModal.html"}}])}(angular),function(e){"use strict";var t=e.module("loaderDirective",[]);t.directive("fullpageLoader",["$rootScope",function(){return{scope:{},link:function(e,t,o){},controller:["$scope","$rootScope",function(e,t){function o(){this.requestsCount=0,this.showLoader=function(){e.loaderVisible=!0,this.requestsCount++},this.hideLoader=function(){console.log("loader fal2se"),this.requestsCount&&(this.requestsCount--,this.requestsCount||(console.log("loader false"),e.loaderVisible=!1))}}t.fullViewLoader=new o,e.loaderVisible=!1}],templateUrl:"src/templates/loaderOverlay.html"}}])}(angular),function(e){"use strict";var t=e.module("BlogsCorousel.Directive",["slickCarousel"]);t.directive("blogsCorousel",["ProjectsModel",function(e){return{scope:{projects:"="},link:function(e,t,o){},controller:["$scope","$http",function(t,o){t.projectsModel=(new e).getInstance(),t.slickConfig={enabled:!0,autoplay:!1,dots:window.innerWidth<=768,arrows:window.innerWidth>768,draggable:!1,slidesToShow:window.innerWidth>=1246?3:window.innerWidth>=768?2:1,method:{},event:{beforeChange:function(e,t,o,n){}}},t.getBlogs=function(){t.projectsModel.getBlogs().then(function(e){t.blogs=e.blogs})},t.getBlogs()}],templateUrl:"src/templates/blogsCorousel.html"}}])}(angular),angular.module("AboutNav.Directive",[]).directive("aboutNav",["$location","$window","$timeout",function(e,t,o){return{restrict:"A",link:function(e,n,r,i){o(function(){if(!navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/iPhone/i)){var o=$(".aboutus-nav-desktop").offset().top-60;angular.element(t).bind("scroll",function(){this.pageYOffset>=o?($(".aboutus-nav-desktop").addClass("about-stikcy-nav"),$(".about-common-parent").addClass("padding-top-50")):($(".aboutus-nav-desktop").removeClass("about-stikcy-nav"),$(".about-common-parent").removeClass("padding-top-50"))}),e.setScrollPosition=function(){$("html, body").animate({scrollTop:o+2},300)}}})}}}]),function(e){"use strict";var t=e.module("Testimonials.Directive",["slickCarousel"]);t.directive("testimonials",[function(){return{scope:{projects:"="},link:function(e,t,o){console.log("Dd")},controller:["$scope",function(e){e.slickConfig={enabled:!0,autoplay:!1,dots:window.innerWidth<=768,arrows:window.innerWidth>768,draggable:!1,method:{},event:{beforeChange:function(e,t,o,n){}}}}],templateUrl:"src/templates/testimonialsCorousel.html"}}])}(angular),function(e){"use strict";var t=e.module("imageLoader",[]);t.directive("imageLoader",["$rootScope",function(){return{scope:{},link:function(e,t,o){},controller:["$scope","$rootScope",function(e,t){$(document).ready(function(){t.fullViewLoader.showLoader();var e=$(".image-load").length,o=0;$(".image-load").each(function(){console.log("here1"),$(this).bind("load",function(){console.log("here2"),o<e?(console.log("here3"),o++,o==e&&t.fullViewLoader.hideLoader(),$(this).attr("src",$(this).attr("src"))):$("html").unbind("load")})})})}]}}])}(angular),function(e){"use strict";var t=e.module("Projects.Model",[]);t.factory("ProjectsModel",["$http",function(e){function t(){this.projects=[],this.projectSelected={},this.amountDonated=0}var o,n="",r="https://www.earth47.com/api";return t.prototype=function(){function t(){var t=this;return e({method:"GET",url:r+"/projects"}).then(function(e){t.projects=e.data.projects},function(e){console.log("Failed to fetch projects")})}function o(t){var o=this;return e({method:"GET",url:r+"/project/"+t}).then(function(e){o.projectSelected=e.data.project},function(e){console.log("Failed to fetch project")})}function n(t){return e({method:"GET",url:r+"/backers/"+t}).then(function(e){return e.data.backers},function(e){console.log("Failed to fetch backers")})}function i(t,o){return e({method:"GET",url:r+"/impact/"+t+"/"+o}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function a(t,o,n){return e({method:"POST",url:r+"/intent",data:{project_id:t,amount:o,payment_option:n}}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function c(){return e({method:"GET",url:r+"/session"}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function l(t){return e({method:"POST",url:r+"/paymentdetails",data:t}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function s(t){return e({method:"POST",url:r+"/contact",data:t}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function u(){return e({method:"GET",url:r+"/logout"}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function d(t){return e({method:"POST",url:r+"/subscribe",data:t}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}function p(){return e({method:"GET",url:r+"/blogs"}).then(function(e){return e.data},function(e){console.log("Failed to fetch impact")})}return{getProjects:t,getProjectById:o,getBackersByProjectId:n,getAmountEnteredImpact:i,postSession:a,getSession:c,postPaymentDetails:l,submitContactForm:s,subscribe:d,logout:u,getBlogs:p}}(),o={getNewInstance:function(){var e=new t;return n=e,e},getInstance:function(){return""===n&&this.getNewInstance(),n}},function(){return o}}])}(angular),function(e){"use strict";var t=e.module("ProjectsListing.Controller",["Projects.Model"]);t.controller("projectsListingController",["$scope","$http","$location","ProjectsModel","$rootScope",function(e,t,o,n,r){function i(e){return e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}e.projectsModel=(new n).getInstance(),r.fullViewLoader.showLoader(),e.projectsModel.getProjects().then(function(){r.fullViewLoader.hideLoader(),e.projectsArray=e.projectsModel.projects,e.projectsArray.forEach(function(e){e.goal_acheived=Math.round(e.achieved_funding/e.target_funding*100)+"%"})}),e.showCardDetails=function(t){var n="";e.projectsArray.forEach(function(o){o.id===t&&(e.projectsModel.projectSelected=o,n=o.title)}),o.url("project/"+t+"/"+i(n))},e.contributeToAll=function(){o.url("project/payment/")}}])}(angular),function(e){"use strict";var t=e.module("ProjectDetail.Controller",["stickyCard","Projects.Model","ExploreProjects.Directive","stickyNav"]);t.controller("projectDetailController",["$scope","$stateParams","$location","$http","ProjectsModel","$rootScope",function(e,t,o,n,r,i){function a(e){return e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}e.projectId=t.projectId,e.projectsModel=(new r).getInstance(),e.currentPageUrl=window.location.href,Object.keys(e.projectsModel.projectSelected).length&&e.projectsModel.projectSelected.id===e.projectId?(e.projectObject=e.projectsModel.projectSelected,e.projectObject.activeImageIndex=0):(i.fullViewLoader.showLoader(),e.projectsModel.getProjectById(e.projectId).then(function(){e.projectObject=e.projectsModel.projectSelected,e.projectObject.goal_acheived=Math.round(e.projectObject.achieved_funding/e.projectObject.target_funding*100)+"%",e.projectObject.activeImageIndex=0,i.fullViewLoader.hideLoader()})),e.toggleImage=function(t){return t?void(e.projectObject.activeImageIndex+=1):void(e.projectObject.activeImageIndex-=1)},e.backThisProject=function(){o.url("project/payment/"+e.projectObject.id+"/"+a(e.projectObject.title))},e.shareOnFb=function(e){e.preventDefault(),FB.ui({method:"share_open_graph",action_type:"og.shares",display:"popup",action_properties:JSON.stringify({object:{"og:url":window.location.href,"og:title":"Build the world you wish to live in","og:description":"Offset your carbon footprint by supporting greenhouse gas reducing projects on Earth 47. Every contributions fights climate and helps build a better tomorrow","og:image":"https://www.earth47.com/src/images/illustrations/social-media-sharing.png","og:image:width":"700","og:image:height":"700"}})})}}])}(angular),function(e){"use strict";var t=e.module("ProjectPayment.Controller",["LoginModal.Directive","Projects.Model"]);t.controller("projectPaymentController",["$scope","$http","$location","$stateParams","ProjectsModel","$rootScope","$timeout",function(e,t,o,n,r,i,a){function c(e){return e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}function l(){e.paymentOption.forEach(function(t){"pay_as_you_like"!==t.type&&(i.fullViewLoader.showLoader(),e.projectsModel.getAmountEnteredImpact(t.amount,t.object).then(function(e){t.impact=e.impact,t.time=e.time,t.co2_reduced=e.co2_impact,s(),i.fullViewLoader.hideLoader()}))})}function s(){"pay_as_you_like"!==e.selectedPaymentOption?e.paymentOption.forEach(function(t){if(e.selectedPaymentOption===t.type)return e.impact.impact=t.impact,e.impact.time=t.time,e.impact.co2_reduced=t.co2_reduced,u(),!1}):(i.fullViewLoader.showLoader(),e.projectsModel.getAmountEnteredImpact(e.amountEntered,e.object).then(function(t){e.impact.impact=t.impact,e.impact.time=t.time,e.impact.co2_reduced=t.co2_impact,u(),i.fullViewLoader.hideLoader()}))}function u(){var t="ton";if(e.impact.co2_reduced<1?(e.impact.co2_reduced=1e3*e.impact.co2_reduced,t="KGs"):e.impact.co2_reduced>1&&(t="tons"),"footprint"===e.object)e.impact.copy='Your contribution will reduce <span class="font-weight-bold font-text-color">'+e.impact.co2_reduced+" "+t+' of CO<sub>2</sub></span> emissions, which is the equivalent of your <span class="font-weight-bold font-text-color">carbon footprint for '+Math.round(e.impact.impact)+" "+e.impact.time+"</span>.";else if("coal"===e.object)e.impact.copy='Your contribution will reduce <span class="font-weight-bold font-text-color">'+e.impact.co2_reduced+" "+t+' of CO<sub>2</sub></span>, which is the amount emitted from burning <span class="font-weight-bold font-text-color">'+Math.round(e.impact.impact)+" KGs of coal.</span>";else if("cars"===e.object)if(e.impact.copy='Your contribution will reduce <span class="font-weight-bold font-text-color">'+e.impact.co2_reduced+" "+t+" of CO<sub>2</sub></span> emissions, which is the equivalent of taking ","years"===e.impact.time){var o=Math.round(e.impact.impact),n=o>1?"cars":"car";e.impact.copy+='<span class="font-weight-bold font-text-color">'+o+" "+n+" off the road for 1 year.</span>"}else e.impact.copy+='<span class="font-weight-bold font-text-color">1 car off the road for '+Math.round(e.impact.impact)+" "+e.impact.time+"</span>.";else if("trees"===e.object){e.impact.copy='Your contribution will reduce <span class="font-weight-bold font-text-color">'+e.impact.co2_reduced+" "+t+" of CO<sub>2</sub></span> emissions, which is the amount absorbed by ";var o=Math.round(e.impact.impact);if("years"===e.impact.time){var n=o>1?"trees":"tree";e.impact.copy+='<span class="font-weight-bold font-text-color">'+o+" white oak "+n+" in 1 year.</span>"}else{var n=o>1?e.impact.time:e.impact.time.slice(0,-1);e.impact.copy+='<span class="font-weight-bold font-text-color">1 white oak tree in '+o+" "+n+"</span>."}}}function d(t){i.fullViewLoader.showLoader(),e.projectsModel.getSession().then(function(o){i.fullViewLoader.hideLoader(),o.user_id?(o.user&&(e.showUserIcon=!0),o.user&&o.user.picture_link&&(e.profilePicLink=o.user.picture_link),e.sessionObject.amount=o.amount,e.sessionObject.project_id=o.project_id,e.sessionObject.user_id=o.user_id,e.sessionObject.user=o.user,e.sessionObject.paymentOption=o.payment_option,t&&(e.amountEntered=e.sessionObject.amount,e.selectedPaymentOption=e.sessionObject.paymentOption,e.paymentOption.forEach(function(t){t.type===e.sessionObject.paymentOption&&(e.object=t.object)}),s()),p()):e.showLoginModal=!0})}function p(){var t={key:"rzp_test_WyK93y9mvps7SN",amount:100*e.sessionObject.amount,name:"Carbon offset",description:"Mitigating "+e.impact.co2_reduced+" tons of CO2",image:"https://www.earth47.com/src/images/illustrations/earth47-logo.svg",handler:function(t){var n={razorpay_payment_id:t.razorpay_payment_id,amount:e.sessionObject.amount,user_id:e.sessionObject.user_id,project_id:e.sessionObject.project_id};e.payAnonymously&&(n.anonymous=!0),i.fullViewLoader.showLoader(),e.projectsModel.postPaymentDetails(n).then(function(){e.projectsModel.amountDonated=n.amount,i.fullViewLoader.hideLoader(),o.url("thankyou")})},prefill:{name:e.sessionObject.user.nickname,email:e.sessionObject.user.email},notes:{project_id:e.projectId},theme:{color:"#35cf00"}},n=new Razorpay(t);n.open()}function m(){e.projectsModel.logout().then(function(){window.location.reload(),console.log("successfull logout ")})}e.projectId=n.projectId,$('[data-toggle="tooltip"]').tooltip(),e.paymentOption=[{caption:"Get Started",amount:250,object:"coal",type:"get_started"},{caption:"Offset Footprint",amount:1500,object:"footprint",type:"footprint"},{caption:"Do More",amount:5e3,object:"cars",type:"do_more"},{caption:"Pay as you like",amount:null,object:"trees",type:"pay_as_you_like"}],e.projectsModel=(new r).getInstance(),e.header=e.projectId?e.projectsModel.projectSelected.title:"EARTH 47",e.amountEntered=1500,e.object="footprint",e.selectedPaymentOption="footprint",e.ownAmountEntered=!1,e.validOwnAmount=!0,e.payAnonymously=!1,e.impact={impact:"",time:"",co2_reduced:"",copy:""},e.sessionObject={},e.isMobile=!1,(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i))&&(e.isMobile=!0),e.showEnterOwnAmount=!1,e.projectId&&!Object.keys(e.projectsModel.projectSelected).length&&(i.fullViewLoader.showLoader(),e.projectsModel.getProjectById(e.projectId).then(function(){e.header=e.projectsModel.projectSelected.title,i.fullViewLoader.hideLoader()})),l(),i.fullViewLoader.showLoader(),e.projectsModel.getBackersByProjectId(e.projectId).then(function(t){e.backersList=t,i.fullViewLoader.hideLoader()}),e.goBack=function(){e.projectId?o.url("project/"+e.projectId+"/"+c(e.projectsModel.projectSelected.title)):o.url("projects")},e.selectPaymentOption=function(t){"pay_as_you_like"===t?(e.showEnterOwnAmount=!0,e.selectedPaymentOption=t,e.amountEntered=null,e.object="trees",e.validOwnAmount=!1,e.errorMessage=null):e.paymentOption.forEach(function(o,n){o.type===t&&(e.ownAmountEntered=!1,e.amountEntered=o.amount,e.object=o.object,e.errorMessage=null,e.validOwnAmount=!0,e.selectedPaymentOption=o.type,s())}),a(function(){e.paymentOption.forEach(function(e){e.type===t?$(".details-block-"+t).show():$(".details-block-"+e.type).hide()})})},e.hideEnterOwnAmountBlock=function(){e.showEnterOwnAmount=!1,e.ownAmountEntered=!0,e.validOwnAmount||e.selectPaymentOption("footprint")},e.validateEnteredAmount=function(t){return t<100?(e.validOwnAmount=!1,void(e.errorMessage="Please enter amount greater than 100")):(e.errorMessage=null,e.validOwnAmount=!0,e.amountEntered=t,s(),void 0)},e.postSession=function(){e.projectsModel.postSession(e.projectId,e.amountEntered,e.selectedPaymentOption).then(function(){d()})},o.search().login?d(!0):(i.fullViewLoader.showLoader(),e.projectsModel.getSession().then(function(t){i.fullViewLoader.hideLoader(),t.user&&t.user_id&&(e.showUserIcon=!0),e.showUserIcon&&t.user.picture_link&&(e.profilePicLink=t.user.picture_link)})),e.hideLoginModal=function(){e.showLoginModal=!1},a(function(){$(".logout-dropdown").hide(),$(".logout-dropdown-icon").click(function(e){e.stopPropagation(),$(".logout-dropdown").show()}),$(document).click(function(){$(".logout-dropdown").hide()}),$(".logout-dropdown").click(function(e){e.stopPropagation(),m()})})}])}(angular),function(e){"use strict";var t=e.module("Thankyou.Controller",["Projects.Model"]);t.controller("thankyou",["$scope","$location","ProjectsModel",function(e,t,o){e.projectsModel=(new o).getInstance(),e.amountDonated=e.projectsModel.amountDonated}])}(angular);